#!/bin/bash

# Проверка количества аргументов
if [ $# -lt 3 ] || [ $# -gt 4 ]; then
    echo "Использование: $0 <строка> <начальная_позиция> <конечная_позиция> [-d]"
    echo "  -d: удалить подстроку вместо выделения (опционально)"
    exit 1
fi

string="$1"
start="$2"
end="$3"
delete_mode=false

# Проверка, активирован ли режим удаления
if [ $# -eq 4 ] && [ "$4" = "-d" ]; then
    delete_mode=true
fi

# Проверка, что позиции - числа
if ! [[ "$start" =~ ^[0-9]+$ ]] || ! [[ "$end" =~ ^[0-9]+$ ]]; then
    echo "Ошибка: начальная и конечная позиции должны быть числами"
    exit 1
fi

# Проверка корректности диапазона
if [ "$start" -gt "$end" ]; then
    echo "Ошибка: начальная позиция не может быть больше конечной"
    exit 1
fi

if [ "$end" -gt "${#string}" ]; then
    echo "Ошибка: конечная позиция превышает длину строки"
    exit 1
fi

# Выделение или удаление подстроки
if [ "$delete_mode" = true ]; then
    # Режим удаления: выводим части до и после указанного диапазона
    part1=$(echo "$string" | cut -c 1-$((start-1)))
    part2=$(echo "$string" | cut -c $((end+1))-)
    result="${part1}${part2}"
else
    # Режим выделения: выводим только указанный диапазон
    result=$(echo "$string" | cut -c "$start"-"$end")
fi

echo "$result"
